<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>03: Indentifying DMRs • methrix</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="03: Indentifying DMRs">
<meta property="og:description" content="methrix">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">methrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.20</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/methrix.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/02-Import.html">01: Reading bedgraph files</a>
    </li>
    <li>
      <a href="../articles/03-QC_reports.html">02: QC and html reports</a>
    </li>
    <li>
      <a href="../articles/04-DMRs.html">03: Indentifying DMRs</a>
    </li>
    <li>
      <a href="../articles/05-Large_cohorts.html">05: Working with large cohorts</a>
    </li>
    <li>
      <a href="../articles/06-Export.html">06: Exporting to standard file formats</a>
    </li>
    <li>
      <a href="../articles/07-Reader_FAQ.html">FAQ: Detailed documentation of the read_bedgraph function.</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>03: Indentifying DMRs</h1>
            
      
      
      <div class="hidden name"><code>04-DMRs.Rmd</code></div>

    </div>

    
    
<div id="differential-methylation-calling" class="section level1">
<h1 class="hasAnchor">
<a href="#differential-methylation-calling" class="anchor"></a>Differential methylation calling</h1>
<div id="dss" class="section level2">
<h2 class="hasAnchor">
<a href="#dss" class="anchor"></a>DSS</h2>
<p>A very important step of a WGBS data analysis is the differential methylation calling. During this step, we would like to identify changes between groups or conditions first on the site level. Then, we will need to identify larger regions (DMR-s, differentially methylated regions) affected by methylation changes that are more likely to represent functional alterations. <code>Methrix</code> doesn’t have a DMR caller, therefore we will use <code>DSS</code>. At this stage, <code>DSS</code> is not yet able to work directly with <code>methrix</code>, therefore we transform our methrix object to <code>bsseq</code> for the sake of DMR calling.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">

<span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"DSS"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"DSS"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">DSS</span><span class="op">)</span></pre></div>
<p>For more detailed description, options and recommendations on smoothing, please refer to the ´DSS´ <a href="https://bioconductor.org/packages/release/bioc/vignettes/DSS/inst/doc/DSS.html">vignette</a></p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="va">bs_obj</span> <span class="op">&lt;-</span> <span class="fu">methrix</span><span class="fu">::</span><span class="fu"><a href="../reference/methrix2bsseq.html">methrix2bsseq</a></span><span class="op">(</span><span class="va">meth</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit">

<span class="va">dmlTest</span> <span class="op">=</span> <span class="fu">DSS</span><span class="fu">::</span><span class="fu">DMLtest</span><span class="op">(</span><span class="va">bs_obj</span>, group1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sample_anno</span><span class="op">)</span><span class="op">[</span><span class="va">sample_anno</span><span class="op">$</span><span class="va">Day</span><span class="op">==</span><span class="st">"D6"</span><span class="op">]</span>, group2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sample_anno</span><span class="op">)</span><span class="op">[</span><span class="va">sample_anno</span><span class="op">$</span><span class="va">Day</span><span class="op">==</span><span class="st">"D14"</span><span class="op">]</span>, 
                       smoothing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
<div id="call-dmrs-and-dmls" class="section level3">
<h3 class="hasAnchor">
<a href="#call-dmrs-and-dmls" class="anchor"></a>Call DMRs and DMLs</h3>
<div class="sourceCode" id="cb4"><pre class="downlit">

<span class="va">dmls</span> <span class="op">=</span> <span class="fu">DSS</span><span class="fu">::</span><span class="fu">callDML</span><span class="op">(</span><span class="va">dmlTest</span>, p.threshold <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="va">dmrs</span> <span class="op">=</span> <span class="fu">DSS</span><span class="fu">::</span><span class="fu">callDMR</span><span class="op">(</span><span class="va">dmlTest</span>, p.threshold <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></pre></div>
<p><strong>DMRs:</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit">

<span class="fu">kable</span><span class="op">(</span><span class="va">dmrs</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kable_styling</span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="st">"striped"</span>, full_width <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">scroll_box</span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="st">"200px"</span><span class="op">)</span></pre></div>
<p><strong>DMLs:</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit">

<span class="fu">kable</span><span class="op">(</span><span class="va">dmls</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kable_styling</span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="st">"striped"</span>, full_width <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">scroll_box</span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="st">"200px"</span><span class="op">)</span></pre></div>
</div>
</div>
<div id="dmr-calling-with-dmrseq" class="section level2">
<h2 class="hasAnchor">
<a href="#dmr-calling-with-dmrseq" class="anchor"></a>DMR calling with <code>dmrseq</code>
</h2>
<p>A popular <code>R</code> package for DMR calling is <code>dmrseq</code>. For more detailed description of the possibilites, see the <a href="http://bioconductor.org/packages/release/bioc/vignettes/dmrseq/inst/doc/dmrseq.html">vignette</a>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">


<span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"dmrseq"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"dmrseq"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dmrseq</span><span class="op">)</span>

<span class="fu">register</span><span class="op">(</span><span class="fu">MulticoreParam</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="va">testCovariate</span> <span class="op">&lt;-</span> <span class="st">"Day"</span>
<span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu">dmrseq</span><span class="op">(</span>bs<span class="op">=</span><span class="va">bs_obj</span><span class="op">[</span><span class="fl">240001</span><span class="op">:</span><span class="fl">260000</span>,<span class="op">]</span>,
                  cutoff <span class="op">=</span> <span class="fl">0.05</span>,
                  testCovariate<span class="op">=</span><span class="va">testCovariate</span>, verbose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">regions</span>, <span class="st">"dmrseq_regions.RDS"</span><span class="op">)</span></pre></div>
</div>
</div>
<div id="visualizing-dmrs-and-candidate-regions" class="section level1">
<h1 class="hasAnchor">
<a href="#visualizing-dmrs-and-candidate-regions" class="anchor"></a>Visualizing DMRs and candidate regions</h1>
<div id="visualizing-a-region" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizing-a-region" class="anchor"></a>Visualizing a region</h2>
<p>We can visualize certain regions and/or DMRs using the <a href="https://bioconductor.org/packages/release/bioc/html/Gviz.html">Gviz</a> package. The plotting function is included in the <a href="https://github.com/CompEpigen/WGBS_best_practice/blob/master/best_practices_WGBS.Rmd">best_practices_WGBS.Rmd</a> file.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">dmrs</span> <span class="op">&lt;-</span> <span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">dmrs</span>, keep.extra.columns <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="va">genome</span> <span class="op">&lt;-</span> <span class="st">"hg19"</span>
<span class="va">mart</span> <span class="op">&lt;-</span> <span class="fu">useMart</span><span class="op">(</span>biomart<span class="op">=</span><span class="st">"ENSEMBL_MART_ENSEMBL"</span>, host<span class="op">=</span><span class="st">"feb2014.archive.ensembl.org"</span>, dataset<span class="op">=</span><span class="st">"hsapiens_gene_ensembl"</span><span class="op">)</span>



<span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">5</span>

<span class="co">#candidate_region &lt;- GRanges(paste0(seqlevels(dmrs)[i], ":", start(dmrs)[i], "-", end(dmrs)[i]))</span>
<span class="va">candidate_region</span> <span class="op">&lt;-</span> <span class="va">dmrs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
<span class="fu">region_plot</span><span class="op">(</span>m <span class="op">=</span> <span class="va">meth</span>, region<span class="op">=</span><span class="va">candidate_region</span>, mart<span class="op">=</span><span class="va">mart</span>, genome<span class="op">=</span><span class="va">genome</span>, groups<span class="op">=</span><span class="va">meth</span><span class="op">$</span><span class="va">Day</span>, dmrs<span class="op">=</span><span class="va">dmrs</span><span class="op">)</span>
<span class="co">#the region_plot function is available in the best_practices.Rmd file. </span></pre></div>
</div>
<div id="heatmap-of-dmrs" class="section level2">
<h2 class="hasAnchor">
<a href="#heatmap-of-dmrs" class="anchor"></a>Heatmap of DMRs</h2>
<div class="sourceCode" id="cb10"><pre class="downlit">

<span class="va">heatmap_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu">methrix</span><span class="fu">::</span><span class="fu"><a href="../reference/get_region_summary.html">get_region_summary</a></span><span class="op">(</span><span class="va">meth</span>, <span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">dmrs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">heatmap_data</span> <span class="op">&lt;-</span> <span class="va">heatmap_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">heatmap_data</span><span class="op">)</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">heatmap_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">heatmap_data</span><span class="op">$</span><span class="va">chr</span>,<span class="st">":"</span>, <span class="va">heatmap_data</span><span class="op">$</span><span class="va">start</span>, <span class="st">"-"</span>, <span class="va">heatmap_data</span><span class="op">$</span><span class="va">end</span><span class="op">)</span>
<span class="fu">pheatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap</a></span><span class="op">(</span><span class="va">heatmap_data</span><span class="op">[</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span>, show_rownames <span class="op">=</span> <span class="cn">FALSE</span>, annotation_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">meth</span><span class="op">@</span><span class="va">colData</span><span class="op">)</span>, 
                   fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></pre></div>
</div>
<div id="number-and-size-of-dmrs" class="section level2">
<h2 class="hasAnchor">
<a href="#number-and-size-of-dmrs" class="anchor"></a>Number and size of DMRs</h2>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"plotly"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"plotly"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"scales"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"scales"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">plotly</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit">

<span class="va">count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Higher methylation in day 14"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">dmrs</span><span class="op">[</span><span class="va">dmrs</span><span class="op">$</span><span class="va">diff.Methy</span><span class="op">&lt;</span><span class="fl">0</span>,<span class="op">]</span><span class="op">)</span>,
           <span class="st">"Higher methylation in day 6"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">dmrs</span><span class="op">[</span><span class="va">dmrs</span><span class="op">$</span><span class="va">diff.Methy</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">length</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Higher methylation in day 14"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu">width</span><span class="op">(</span><span class="va">dmrs</span><span class="op">[</span><span class="va">dmrs</span><span class="op">$</span><span class="va">diff.Methy</span><span class="op">&lt;</span><span class="fl">0</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>, 
            <span class="st">"Higher methylation in day 6"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu">width</span><span class="op">(</span><span class="va">dmrs</span><span class="op">[</span><span class="va">dmrs</span><span class="op">$</span><span class="va">diff.Methy</span><span class="op">&lt;</span><span class="fl">0</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> 


<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Direction<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gain"</span>, <span class="st">"Loss"</span><span class="op">)</span>, Count<span class="op">=</span><span class="va">count</span>, Length<span class="op">=</span><span class="va">length</span><span class="op">)</span>

   <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">data</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, y<span class="op">=</span><span class="va">Count</span>, fill<span class="op">=</span><span class="va">Direction</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Number of differentially methylated regions"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">comma</span><span class="op">)</span>
<span class="fu">ggplotly</span><span class="op">(</span><span class="va">g</span><span class="op">)</span>
   <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">data</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, y<span class="op">=</span><span class="va">Length</span>, fill<span class="op">=</span><span class="va">Direction</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Length of differentially methylated regions"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">comma</span><span class="op">)</span>
<span class="fu">ggplotly</span><span class="op">(</span><span class="va">p</span><span class="op">)</span>
   </pre></div>
</div>
</div>
<div id="region-annotation" class="section level1">
<h1 class="hasAnchor">
<a href="#region-annotation" class="anchor"></a>Region annotation</h1>
<p>To describe and interpret the differentially methylated regions, we can use the <code>ChIPseeker</code> package. The location of the DMRs can already give us a hint the involved processes, but once we assign the regions to genes, a pathway enrichment analysis is also possible. For additional details, see the <a href="https://bioconductor.org/packages/release/bioc/vignettes/ChIPseeker/inst/doc/ChIPseeker.html">vignette</a> of <code>ChIPseeker</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="co">## loading packages</span>
<span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"ChIPseeker"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"ChIPseeker"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"TxDb.Hsapiens.UCSC.hg19.knownGene"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"TxDb.Hsapiens.UCSC.hg19.knownGene"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"ReactomePA"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"ReactomePA"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"clusterProfiler"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"clusterProfiler"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ChIPseeker</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span><span class="op">)</span>
<span class="va">txdb</span> <span class="op">&lt;-</span> <span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ReactomePA</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">clusterProfiler</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit">
 

  <span class="va">peakAnnoList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Higher in day 14"</span><span class="op">=</span><span class="va">dmrs</span><span class="op">[</span><span class="va">dmrs</span><span class="op">$</span><span class="va">diff.Methy</span><span class="op">&lt;</span><span class="fl">0</span>,<span class="op">]</span>, <span class="st">"Higher in day 6"</span> <span class="op">=</span> <span class="va">dmrs</span><span class="op">[</span><span class="va">dmrs</span><span class="op">$</span><span class="va">diff.Methy</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="op">]</span><span class="op">)</span>, <span class="va">annotatePeak</span>, TxDb<span class="op">=</span><span class="va">txdb</span>, tssRegion<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3000</span>, <span class="fl">3000</span><span class="op">)</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="fu">plotAnnoBar</span><span class="op">(</span><span class="va">peakAnnoList</span><span class="op">)</span>
<span class="fu">plotDistToTSS</span><span class="op">(</span><span class="va">peakAnnoList</span><span class="op">)</span>



<span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Higher in day 14"</span><span class="op">=</span><span class="va">dmrs</span><span class="op">[</span><span class="va">dmrs</span><span class="op">$</span><span class="va">diff.Methy</span><span class="op">&lt;</span><span class="fl">0</span>,<span class="op">]</span>, <span class="st">"Higher in day 6"</span> <span class="op">=</span> <span class="va">dmrs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span><span class="op">)</span>, <span class="va">seq2gene</span>, tssRegion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>, <span class="fl">1000</span><span class="op">)</span>, flankDistance <span class="op">=</span> <span class="fl">3000</span>, TxDb<span class="op">=</span><span class="va">txdb</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">genes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">genes</span><span class="op">)</span><span class="op">)</span>
<span class="va">comppthw</span> <span class="op">&lt;-</span> <span class="fu">compareCluster</span><span class="op">(</span>geneCluster   <span class="op">=</span> <span class="va">genes</span>,
                         fun           <span class="op">=</span> <span class="st">"enrichPathway"</span>,
                         pvalueCutoff  <span class="op">=</span> <span class="fl">0.05</span>,
                         pAdjustMethod <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/graphics-defunct.html">dotplot</a></span><span class="op">(</span><span class="va">comppthw</span>, font.size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/gc.html">gc</a></span><span class="op">(</span><span class="op">)</span></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Anand Mayakonda, Reka Toth.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
