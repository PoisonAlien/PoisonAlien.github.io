<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FAQ: Detailed documentation of the read_bedgraph function. • methrix</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="FAQ: Detailed documentation of the read_bedgraph function.">
<meta property="og:description" content="methrix">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">methrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.20</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/methrix.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/02-Import.html">01: Reading bedgraph files</a>
    </li>
    <li>
      <a href="../articles/03-QC_reports.html">02: QC and html reports</a>
    </li>
    <li>
      <a href="../articles/04-DMRs.html">03: Indentifying DMRs</a>
    </li>
    <li>
      <a href="../articles/05-Large_cohorts.html">05: Working with large cohorts</a>
    </li>
    <li>
      <a href="../articles/06-Export.html">06: Exporting to standard file formats</a>
    </li>
    <li>
      <a href="../articles/07-Reader_FAQ.html">FAQ: Detailed documentation of the read_bedgraph function.</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>FAQ: Detailed documentation of the read_bedgraph function.</h1>
            
            <h4 class="date">2020-10-14</h4>
      
      
      <div class="hidden name"><code>07-Reader_FAQ.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The core functionality of <code>methrix</code> is a generic reader function for virtually every possible format of single sample bed, bedGraph or txt files.</p>
<p>This description helps the users to find the correct settings for their own files.</p>
<div id="generic-settings" class="section level2">
<h2 class="hasAnchor">
<a href="#generic-settings" class="anchor"></a>Generic settings</h2>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="co">#Load library</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">methrix</span><span class="op">)</span></pre></div>
<div id="files-and-annotation" class="section level3">
<h3 class="hasAnchor">
<a href="#files-and-annotation" class="anchor"></a>Files and annotation</h3>
<p>A character list of the files with their paths’.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">

<span class="va">bdg_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>
  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, package <span class="op">=</span> <span class="st">'methrix'</span><span class="op">)</span>,
  pattern <span class="op">=</span> <span class="st">"*bedGraph\\.gz$"</span>,
  full.names <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></pre></div>
<p>The sample annotation is a <code>data.frame</code> containing all annotations we would like to have in the final object. The rownames will be used as sample names.</p>
<p>** The sample annotation and the file list should have the same order! **</p>
<p>Since the filenames and the sample names can be different, there is no way to check if the order is correct during reading in. Therefore the user has to take care that they are in the correct order.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="co">#Generate some sample annotation table</span>
<span class="va">sample_anno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span>
    pattern <span class="op">=</span> <span class="st">"\\.bedGraph\\.gz$"</span>,
    replacement <span class="op">=</span> <span class="st">""</span>,
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html">basename</a></span><span class="op">(</span><span class="va">bdg_files</span><span class="op">)</span>
  <span class="op">)</span>,
  Condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cancer"</span>, <span class="st">'cancer'</span>, <span class="st">"normal"</span>, <span class="st">"normal"</span><span class="op">)</span>,
  Pair <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pair1"</span>, <span class="st">"pair2"</span>, <span class="st">"pair1"</span>, <span class="st">"pair2"</span><span class="op">)</span>,
  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">sample_anno</span><span class="op">)</span></pre></div>
<p>The sample names will be changed if they contain not allowed characters (e.g. space) or don’t follow the R naming conventions (e.g. starts with number). In this case a warning will appear during read in.</p>
<p>It is possible not to provide annotation data. In this case the sample names will be converted from the filenames and the <code>colData</code> slot of the <code>methrix</code> object will be empty.</p>
</div>
<div id="reference-data" class="section level3">
<h3 class="hasAnchor">
<a href="#reference-data" class="anchor"></a>Reference data</h3>
<p><code>methrix</code> is using <code>BSgenome</code> packages to find the reference position of the CpG sites in the genome. This package will not only read in the measured methylation values, but fills it into an object that contains all possible CpGs on the genome. This also allows to perform genome-wide statistics for example on covergage. The relevant <code>BSgenome</code> package has to be installed. The user can define the name of the <code>BSgenome</code> package or use the <code>extract_CPGs</code> function with the given genome and provide the resulting object as reference.</p>
<p>The argument <code>ref_build</code> is an additional argument for the user’s information. It doesn’t affect the reading functionality. Optional.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co">#Genome of your preference to work with</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">BiocManager</span><span class="op">)</span>

<span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"BSgenome.Hsapiens.UCSC.hg19"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"BSgenome.Hsapiens.UCSC.hg19"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">BSgenome.Hsapiens.UCSC.hg19</span><span class="op">)</span> </pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="co">#First extract genome wide CpGs from the desired reference genome</span>
<span class="va">hg19_cpgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu">methrix</span><span class="fu">::</span><span class="fu"><a href="../reference/extract_CPGs.html">extract_CPGs</a></span><span class="op">(</span>ref_genome <span class="op">=</span> <span class="st">"BSgenome.Hsapiens.UCSC.hg19"</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="co">#Read the files </span>
<span class="va">meth</span> <span class="op">&lt;-</span> <span class="fu">methrix</span><span class="fu">::</span><span class="fu"><a href="../reference/read_bedgraphs.html">read_bedgraphs</a></span><span class="op">(</span>
  files <span class="op">=</span> <span class="va">bdg_files</span>,
  ref_cpgs <span class="op">=</span> <span class="va">hg19_cpgs</span>,
  chr_idx <span class="op">=</span> <span class="fl">1</span>,
  start_idx <span class="op">=</span> <span class="fl">2</span>,
  M_idx <span class="op">=</span> <span class="fl">3</span>,
  U_idx <span class="op">=</span> <span class="fl">4</span>,
  stranded <span class="op">=</span> <span class="cn">FALSE</span>,
  zero_based <span class="op">=</span> <span class="cn">FALSE</span>, 
  coldata <span class="op">=</span> <span class="va">sample_anno</span>
<span class="op">)</span>
<span class="co">#or just use the name of the BSgenome package</span>

<span class="co">#Read the files </span>
<span class="co">#meth &lt;- methrix::read_bedgraphs(</span>
<span class="co">#  files = bdg_files,</span>
<span class="co">#  ref_cpgs = "BSgenome.Hsapiens.UCSC.hg19",</span>
<span class="co">#  chr_idx = 1,</span>
<span class="co">#  start_idx = 2,</span>
<span class="co">#  M_idx = 3,</span>
<span class="co">#  U_idx = 4,</span>
<span class="co">#  stranded = FALSE,</span>
<span class="co">#  zero_based = FALSE, </span>
<span class="co">#  collapse_strands = FALSE, </span>
<span class="co">#  coldata = sample_anno</span>
<span class="co">#)</span></pre></div>
<p>The <code>contigs</code> argument restricts the coontigs used during read in. Defaults to all autosomes and sex chromosomes. Please keep in mind that this function was not tested will all possible organisms.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="va">meth</span> <span class="op">&lt;-</span> <span class="fu">methrix</span><span class="fu">::</span><span class="fu"><a href="../reference/read_bedgraphs.html">read_bedgraphs</a></span><span class="op">(</span>
  files <span class="op">=</span> <span class="va">bdg_files</span>,
  ref_cpgs <span class="op">=</span> <span class="va">hg19_cpgs</span>,
  chr_idx <span class="op">=</span> <span class="fl">1</span>,
  start_idx <span class="op">=</span> <span class="fl">2</span>,
  M_idx <span class="op">=</span> <span class="fl">3</span>,
  U_idx <span class="op">=</span> <span class="fl">4</span>,
  contigs <span class="op">=</span> <span class="st">"chr21"</span>,
  stranded <span class="op">=</span> <span class="cn">FALSE</span>,
  zero_based <span class="op">=</span> <span class="cn">FALSE</span>, 
  coldata <span class="op">=</span> <span class="va">sample_anno</span>
<span class="op">)</span></pre></div>
<p>Changing sample names:</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="co">#Generate some sample annotation table</span>
<span class="va">sample_anno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span>
    pattern <span class="op">=</span> <span class="st">"\\.bedGraph\\.gz$"</span>,
    replacement <span class="op">=</span> <span class="st">""</span>,
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html">basename</a></span><span class="op">(</span><span class="va">bdg_files</span><span class="op">)</span>
  <span class="op">)</span>,
  Condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cancer"</span>, <span class="st">'cancer'</span>, <span class="st">"normal"</span>, <span class="st">"normal"</span><span class="op">)</span>,
  Pair <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pair1"</span>, <span class="st">"pair2"</span>, <span class="st">"pair1"</span>, <span class="st">"pair2"</span><span class="op">)</span>,
  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sample_anno</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"1 "</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sample_anno</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">sample_anno</span><span class="op">)</span>

<span class="va">meth</span> <span class="op">&lt;-</span> <span class="fu">methrix</span><span class="fu">::</span><span class="fu"><a href="../reference/read_bedgraphs.html">read_bedgraphs</a></span><span class="op">(</span>
  files <span class="op">=</span> <span class="va">bdg_files</span>,
  ref_cpgs <span class="op">=</span> <span class="va">hg19_cpgs</span>,
  chr_idx <span class="op">=</span> <span class="fl">1</span>,
  start_idx <span class="op">=</span> <span class="fl">2</span>,
  M_idx <span class="op">=</span> <span class="fl">3</span>,
  U_idx <span class="op">=</span> <span class="fl">4</span>,
  stranded <span class="op">=</span> <span class="cn">FALSE</span>,
  zero_based <span class="op">=</span> <span class="cn">FALSE</span>, 
  coldata <span class="op">=</span> <span class="va">sample_anno</span>
<span class="op">)</span></pre></div>
</div>
<div id="predifined-pipelines" class="section level3">
<h3 class="hasAnchor">
<a href="#predifined-pipelines" class="anchor"></a>Predifined pipelines</h3>
<p><code>methrix</code> automatically assigns the column layout for many widely used software outputs. Currently supported:</p>
<ul>
<li><p><a href="https://rawgit.com/FelixKrueger/Bismark/master/Docs/Bismark_User_Guide.html#iv-bismark-methylation-extractor">Bismark_cov</a></p></li>
<li><p><a href="https://github.com/dpryan79/MethylDackel">MethylDackel</a> - default MethylDackel extract output</p></li>
<li><p><a href="https://github.com/hovestadt/methylCtools">MethylcTools</a></p></li>
<li><p><a href="http://people.csail.mit.edu/dnaase/bissnp2011/">BisSNP</a></p></li>
<li><p>“BSseeker2_CGmap”, <a href="https://github.com/BSSeeker/BSseeker2">BSseeker2</a> used with <a href="https://cgmaptools.github.io/">CGmapTools</a></p></li>
</ul>
<p>If these pipelines are used, the user doesn’t have to define the following arguments: <code>chr_idx</code>, <code>start_idx</code>, <code>end_idx</code>, <code>beta_idx</code>, <code>M_idx</code>, <code>U_idx</code>, <code>strand_idx</code>, <code>cov_idx</code></p>
<p>If they are still defined, they won’t be taken into account.</p>
</div>
<div id="idx-columns" class="section level3">
<h3 class="hasAnchor">
<a href="#idx-columns" class="anchor"></a>idx columns</h3>
<ul>
<li>Required: <code>chr_idx</code> and <code>start_idx</code> for identifying the position.</li>
<li>
<p>A combination of M (count of methylated reads), U (count of unmethylated reads), beta (beta methylation value) and coverage (read count) so that all the values can be calculated. Accepted combinations:</p>
<pre><code>                                  * M and U
                                  * M and coverage 
                                  * U and coverage
                                  * beta and coverage</code></pre>
</li>
</ul>
<p>The beta value can be either percentage or ratio. The function will check the first lines and will convert it to ratio.</p>
</div>
<div id="strandedness" class="section level3">
<h3 class="hasAnchor">
<a href="#strandedness" class="anchor"></a>Strandedness</h3>
<p>It is very important to correctly set the strandedness in order to have the correct methylation values.</p>
<p>Arguments:</p>
<ul>
<li>
<code>stranded</code> Is the data in stranded format? If for each CpG position there are two values, the data is stranded. In many cases the strand information is available (+ or -).</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="co">#chr21 27866423  2 8 +</span>
<span class="co">#chr21 27866424  1 3 -</span>
<span class="co">#chr21 27866921  2  2 +</span>
<span class="co">#chr21 27866923  3  2 -</span>
<span class="co">#chr21 27867197  1  2 +</span>
<span class="co">#chr21 27867198  1  7 -</span></pre></div>
<p>In some cases the strand information is not available, but one can infer from the position:</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="co">#chr21 27866423  2 8 </span>
<span class="co">#chr21 27866424  1 3 </span>
<span class="co">#chr21 27866921  2  2 </span>
<span class="co">#chr21 27866923  3  2 </span>
<span class="co">#chr21 27867197  1  2 </span>
<span class="co">#chr21 27867198  1  7 </span></pre></div>
<ul>
<li><p><code>collapse_strands</code> If TRUE, the read in function will collapse the reads and summarize their methylation value. Usually, this option is set to TRUE, except in some special cases.</p></li>
<li><p><code>synced_coordinates</code> In some rare cases, the coordinates are the same for the + and - strands with no strand information available:</p></li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit">

<span class="co">#chr21 27866423  27866425 2   8 </span>
<span class="co">#chr21 27866423  27866425 1   3 </span>
<span class="co">#chr21 27866921  27866923 2   2 </span>
<span class="co">#chr21 27866921  27866923 3   2 </span>
<span class="co">#chr21 27867197  27867198 1   2 </span>
<span class="co">#chr21 27867197  27867198 1   7 </span></pre></div>
</div>
</div>
<div id="specific-settings" class="section level2">
<h2 class="hasAnchor">
<a href="#specific-settings" class="anchor"></a>Specific settings</h2>
<p>During read in the user have to decide on parameters that are mostly affected by the available resources. If the study population is not so big or there is ample of RAM available, one can go for using in-memory object and read in in batches, as well as parallel processing. This is the fastest way.</p>
<ul>
<li>
<code>vect</code> if one chooses the vectorized processing, the data will be processed in batches: the read in is not performed one by one, but is done on multiple files at once.</li>
<li>
<code>vect_batch_size</code> defines the number of samples that should be processed at the same time. It is defined by the available memory. If e.g. <code>vect_batch_size=5</code>, 5 bedgraph files will be in the memory at the same time.</li>
<li>
<code>n_threads</code> not available on Windows. The reading will be separated on multiple cores. Be careful: it will cause a linear increase in memory usage.</li>
</ul>
<div id="hdf5-backend" class="section level3">
<h3 class="hasAnchor">
<a href="#hdf5-backend" class="anchor"></a>HDF5 backend</h3>
<p>If the memory is limited and/or the study population is large, there is an option to use HDF5 backend.<br>
Only one bedgraph file is in the memory at the same time, while the resulting object won’t be stored in the memory, but on-disk. Additional arguments to use HDF5:</p>
<ul>
<li>Set <code>h5=TRUE</code>
</li>
<li>Set <code>vect=FALSE</code>
</li>
<li>h5_dir –&gt; a directory to save the final object. It is possible to save the object later. It increases the processing time significantly.<br>
</li>
<li>h5temp –&gt; a temporary directory to use during data processing. Set this if for example the default temporary location doesn’t have enough free space to store the temporary data.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit">

<span class="va">meth</span> <span class="op">&lt;-</span> <span class="fu">methrix</span><span class="fu">::</span><span class="fu"><a href="../reference/read_bedgraphs.html">read_bedgraphs</a></span><span class="op">(</span>
  files <span class="op">=</span> <span class="va">bdg_files</span>,
  ref_cpgs <span class="op">=</span> <span class="va">hg19_cpgs</span>,
  chr_idx <span class="op">=</span> <span class="fl">1</span>,
  start_idx <span class="op">=</span> <span class="fl">2</span>,
  M_idx <span class="op">=</span> <span class="fl">3</span>,
  U_idx <span class="op">=</span> <span class="fl">4</span>,
  stranded <span class="op">=</span> <span class="cn">FALSE</span>,
  zero_based <span class="op">=</span> <span class="cn">FALSE</span>, 
  coldata <span class="op">=</span> <span class="va">sample_anno</span>,
  vect <span class="op">=</span> <span class="cn">FALSE</span>,
  h5 <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Anand Mayakonda, Reka Toth.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
